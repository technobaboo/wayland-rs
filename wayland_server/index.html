<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Interface for interacting with the Wayland protocol, server-side."><meta name="keywords" content="rust, rustlang, rust-lang, wayland_server"><title>wayland_server - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Regular.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Medium.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Bold.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Semibold.ttf.woff2"><link rel="stylesheet" href="../normalize.css"><link rel="stylesheet" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" href="../ayu.css" disabled><link rel="stylesheet" href="../dark.css" disabled><link rel="stylesheet" href="../light.css" id="themeStyle"><script id="default-settings" ></script><script src="../storage.js"></script><script defer src="../crates.js"></script><script defer src="../main.js"></script><noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../favicon.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../wayland_server/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></div></a><h2></h2></nav><nav class="sidebar"><a class="sidebar-logo" href="../wayland_server/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></div></a><h2 class="location"><a href="#">Crate wayland_server</a></h2><div class="sidebar-elems"><ul class="block"><li class="version">Version 0.30.0</li><li><a id="all-types" href="all.html">All Items</a></li></ul><section><ul class="block"><li><a href="#modules">Modules</a></li><li><a href="#macros">Macros</a></li><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li><li><a href="#traits">Traits</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../wheel.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1 class="fqn">Crate <a class="mod" href="#">wayland_server</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../clipboard.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../src/wayland_server/lib.rs.html#1-321">source</a> · <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Interface for interacting with the Wayland protocol, server-side.</p>
<h3 id="general-concepts"><a href="#general-concepts">General concepts</a></h3>
<p>This crate is structured around four main objects: the <a href="struct.Display.html" title="Display"><code>Display</code></a> and <a href="struct.DisplayHandle.html" title="DisplayHandle"><code>DisplayHandle</code></a> structs,
resources (objects implementing the <a href="trait.Resource.html" title="Resource"><code>Resource</code></a> trait), and the <a href="trait.Dispatch.html" title="Dispatch"><code>Dispatch</code></a> trait.</p>
<p>The <a href="struct.Display.html" title="Display"><code>Display</code></a> is the heart of this crate, it represents the protocol state of your Wayland server, and
takes care of processing messages from clients. You’ll need to integrate it in your event loop (see its
documentation for details). From it you can retrieve the <a href="struct.DisplayHandle.html" title="DisplayHandle"><code>DisplayHandle</code></a>, which is a clonable handle to
the Wayland state and is the type used to actually interact with the protocol.</p>
<p>Each of the Wayland object you can manipulate is represented by a struct implementing the <a href="trait.Resource.html" title="Resource"><code>Resource</code></a>
trait. Thos structs are automatically generated from the wayland XML protocol specification. This crate
provides the types generated from the core protocol in the <a href="protocol/index.html" title="protocol"><code>protocol</code></a> module. For other standard
protocols, see the <code>wayland-protocols</code> crate.</p>
<h3 id="request-dispatching-and-the-dispatch-trait"><a href="#request-dispatching-and-the-dispatch-trait">Request dispatching and the <code>Dispatch</code> trait</a></h3>
<p>The request dispatching logic provided by this crate is build around the <a href="trait.Dispatch.html" title="Dispatch"><code>Dispatch</code></a> trait. During the
dispatching process (in <a href="struct.Display.html#method.dispatch_clients" title="Display::dispatch_clients()"><code>Display::dispatch_clients()</code></a>), all requests sent by clients are read from
their respective process and delivered to your processing logic, by invoking methods on the various
<a href="trait.Dispatch.html" title="Dispatch"><code>Dispatch</code></a> implementations of your <code>State</code> struct. In this paradigm, your <code>State</code> needs to implement
<code>Dispatch&lt;O, _&gt;</code> for every Wayland object <code>O</code> it needs to process events for.</p>
<p>However, implementing all those traits on your own is a lot of (often uninteresting) work. To make this
easier a composition mechanism is provided using the <a href="macro.delegate_dispatch.html" title="delegate_dispatch!"><code>delegate_dispatch!</code></a> macro. This way, another
library (such as Smithay) can provide generic <a href="trait.Dispatch.html" title="Dispatch"><code>Dispatch</code></a> implementations that you can reuse on your
own app by delegating those objects to that provided implementation. See the documentation of those
traits and macro for details.</p>
<h3 id="globals"><a href="#globals">Globals</a></h3>
<p>The entry point of the protocol for clients goes through the protocol globals. Each global represents a
capability of your compositor, a peripheral it has access to, or a protocol extension it supports.
Globals are created by you using <a href="struct.DisplayHandle.html#method.create_global" title="DisplayHandle::create_global()"><code>DisplayHandle::create_global()</code></a>, and require your <code>State</code> to
implement the <a href="trait.GlobalDispatch.html" title="GlobalDispatch"><code>GlobalDispatch</code></a> trait for the interface associated with that global.</p>
<h3 id="logging"><a href="#logging">Logging</a></h3>
<p>This crate can generate some runtime error message (notably when a protocol error occurs). By default
those messages are printed to stderr. If you activate the <code>log</code> cargo feature, they will instead be
piped through the <code>log</code> crate.</p>
<h3 id="advanced-use"><a href="#advanced-use">Advanced use</a></h3><h4 id="bypassing-dispatch"><a href="#bypassing-dispatch">Bypassing <code>Dispatch</code></a></h4>
<p>It may be that for some of your objects, handling them via the <a href="trait.Dispatch.html" title="Dispatch"><code>Dispatch</code></a> trait is impractical. In
those contexts, this crate also provides some escape-hatches to directly interface with the low-level
APIs from <code>wayland-backend</code>, allowing you to register callbacks for those objects by directly providing
implementations of the backend <a href="backend/trait.ObjectData.html"><code>ObjectData</code></a> trait.
See <a href="struct.Client.html#method.create_resource_from_objdata" title="Client::create_resource_from_objdata()"><code>Client::create_resource_from_objdata()</code></a> and <a href="struct.DataInit.html#method.custom_init" title="DataInit::custom_init()"><code>DataInit::custom_init()</code></a>.</p>
<h4 id="interaction-with-ffi"><a href="#interaction-with-ffi">Interaction with FFI</a></h4>
<p>It can happen that you’ll need to interact with Wayland states accross FFI, such as for example when
interfacing with the graphics stack for enabling hardware acceleration for clients.</p>
<p>In this case, you’ll need to do it in two steps, by explicitly working with <code>wayland-backend</code>, adding
it to your dependencies and enabling its <code>server_system</code> feature.</p>
<p>Then, you’ll generally need:</p>
<ul>
<li>The <code>*mut wl_display</code> pointer, that you can retrieve by first retrieving the
<a href="backend/struct.Backend.html"><code>Backend</code></a> using <a href="struct.Display.html#method.backend" title="Display::backend()"><code>Display::backend()</code></a>, and then invoke
`Backend::display_ptr().</li>
<li>The <code>*mut wl_resource</code> pointers for the objects you need to share, by first getting the
<a href="backend/struct.ObjectId.html"><code>ObjectId</code></a> using the <a href="trait.Resource.html#tymethod.id" title="Resource::id()"><code>Resource::id()</code></a> method, and then
the <code>ObjectId::as_ptr()</code> method.</li>
</ul>
<p>If you need to receive pointers from FFI, you can make <a href="backend/struct.ObjectId.html" title="ObjectId"><code>ObjectId</code></a>s from the <code>*mut wl_resource</code> pointers
using <code>ObjectId::from_ptr()</code>, and then make the resources using <a href="trait.Resource.html#tymethod.from_id" title="Resource::from_id"><code>Resource::from_id</code></a>.</p>
</div></details><h2 id="modules" class="small-section-header"><a href="#modules">Modules</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="mod" href="backend/index.html" title="wayland_server::backend mod">backend</a></div><div class="item-right docblock-short">Backend reexports</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="protocol/index.html" title="wayland_server::protocol mod">protocol</a></div><div class="item-right docblock-short">Generated protocol definitions</div></div></div><h2 id="macros" class="small-section-header"><a href="#macros">Macros</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="macro" href="macro.delegate_dispatch.html" title="wayland_server::delegate_dispatch macro">delegate_dispatch</a></div><div class="item-right docblock-short">A helper macro which delegates a set of <a href="trait.Dispatch.html" title="Dispatch"><code>Dispatch</code></a> implementations for a resource to some other type which
provides a generic <a href="trait.Dispatch.html" title="Dispatch"><code>Dispatch</code></a> implementation.</div></div><div class="item-row"><div class="item-left module-item"><a class="macro" href="macro.delegate_global_dispatch.html" title="wayland_server::delegate_global_dispatch macro">delegate_global_dispatch</a></div><div class="item-right docblock-short">A helper macro which delegates a set of <a href="trait.GlobalDispatch.html" title="GlobalDispatch"><code>GlobalDispatch</code></a> implementations for a resource to some other type which
provdes a generic <a href="trait.GlobalDispatch.html" title="GlobalDispatch"><code>GlobalDispatch</code></a> implementation.</div></div></div><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Client.html" title="wayland_server::Client struct">Client</a></div><div class="item-right docblock-short">A struct representing a Wayland client connected to your compositor.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.DataInit.html" title="wayland_server::DataInit struct">DataInit</a></div><div class="item-right docblock-short">Helper to initialize client-created objects</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Display.html" title="wayland_server::Display struct">Display</a></div><div class="item-right docblock-short">The Wayland display</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.DisplayHandle.html" title="wayland_server::DisplayHandle struct">DisplayHandle</a></div><div class="item-right docblock-short">A handle to the Wayland display</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.ListeningSocket.html" title="wayland_server::ListeningSocket struct">ListeningSocket</a></div><div class="item-right docblock-short">An utility representing a unix socket on which your compositor is listening for new clients</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.New.html" title="wayland_server::New struct">New</a></div><div class="item-right docblock-short">A newly created object that needs to be initialized. See <a href="struct.DataInit.html" title="DataInit"><code>DataInit</code></a>.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.ResourceData.html" title="wayland_server::ResourceData struct">ResourceData</a></div><div class="item-right docblock-short">The <a href="backend/trait.ObjectData.html" title="ObjectData"><code>ObjectData</code></a> implementation that is internally used by this crate</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Weak.html" title="wayland_server::Weak struct">Weak</a></div><div class="item-right docblock-short">A weak handle to a Wayland object</div></div></div><h2 id="enums" class="small-section-header"><a href="#enums">Enums</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.BindError.html" title="wayland_server::BindError enum">BindError</a></div><div class="item-right docblock-short">Error that can occur when trying to bind a <a href="struct.ListeningSocket.html" title="ListeningSocket"><code>ListeningSocket</code></a></div></div><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.DispatchError.html" title="wayland_server::DispatchError enum">DispatchError</a></div><div class="item-right docblock-short">An error generated if an illegal request was received from a client</div></div><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.WEnum.html" title="wayland_server::WEnum enum">WEnum</a></div><div class="item-right docblock-short">An enum value in the protocol.</div></div></div><h2 id="traits" class="small-section-header"><a href="#traits">Traits</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.Dispatch.html" title="wayland_server::Dispatch trait">Dispatch</a></div><div class="item-right docblock-short">A trait which provides an implementation for handling a client’s requests from a resource with some type
of associated user data.</div></div><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.GlobalDispatch.html" title="wayland_server::GlobalDispatch trait">GlobalDispatch</a></div><div class="item-right docblock-short">A trait which provides an implementation for handling advertisement of a global to clients with some type
of associated user data.</div></div><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.Resource.html" title="wayland_server::Resource trait">Resource</a></div><div class="item-right docblock-short">Trait representing a Wayland interface</div></div></div></section></div></main><div id="rustdoc-vars" data-root-path="../" data-current-crate="wayland_server" data-themes="ayu,dark,light" data-resource-suffix="" data-rustdoc-version="1.66.0 (69f9c33d7 2022-12-12)" ></div></body></html>